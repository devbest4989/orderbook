.form-horizontal.form-label-left{:style => "overflow:auto;"}
  .row.no-margin  
    .col-md-6.col-sm-6.col-xs-12
      %h1= @sales_order.customer.company_title
    .col-md-6.col-sm-6.col-xs-12.text-right
      %h4.invoice_number=@sales_order_invoice.token unless @sales_order_invoice.nil?
  .row.no-margin  
    .col-md-6.col-sm-6.col-xs-12
      %h4= @sales_order.customer.billing_address
    .col-md-6.col-sm-6.col-xs-12
      %h4.invoice_date
        Date: 
        =@sales_order_invoice.created_at.to_date unless @sales_order_invoice.nil?
  .row.no-margin  
    .col-md-6.col-sm-6.col-xs-12
      %h5="Phone: #{@sales_order.customer.phone}"
      %h5="Fax: #{@sales_order.customer.fax}"
    .col-md-6.col-sm-6.col-xs-12
      %h5="Sales Order: #{@sales_order.token}"
      %h5="Processed By: #{@sales_order.booker.full_name}"
  .row.no-margin  
    .col-md-6.col-sm-6.col-xs-12
      %h4 
      %h5="#{@company_profiles['company.name']}"
      %h5="#{@company_profiles['company.address']}"
    .col-md-6.col-sm-6.col-xs-12
      %h4 Deliver To
      %h5="#{@sales_order.customer.company_title}"
      %h5="#{@sales_order.ship_street} #{@sales_order.ship_suburb}"
      %h5="#{@sales_order.ship_city} #{@sales_order.ship_postcode}"
      %h5="#{@sales_order.ship_state} #{Country.coded(@sales_order.ship_country).name}"
      %input#invoice_remove_url{type: 'hidden', value: "#{remove_activity_sales_order_path(@sales_order)}"}
      %input#invoice_get_url{type: 'hidden', value: "#{get_invoice_sales_order_path(@sales_order)}"}

  .row.no-margin  
    %table#product_list.table.projects.margin-bottom-5{:style => "table-layout: fixed;"}
      %thead
        %tr
          %th{ width: '30%' } Product Name
          %th Quantity
          %th Unit Price
          %th Discount (%)
          %th Tax (%)
          %th{ width: '20%' } Amount
      %tbody
      - unless @sales_order_invoice.nil?
        - @sales_order.sales_item_activities.where(activity: 'ship').where(token: @sales_order_invoice.activity_data).each do |item|
          %tr
            %td 
              =item.sales_item.sold_item.name    
            %td 
              =item.quantity
            %td 
              ="$ #{item.sales_item.unit_price}"
            %td 
              =item.sales_item.discount_rate
            %td 
              =item.sales_item.tax_rate
            %td 
              =item.sub_total
    - unless @sales_order_invoice.nil?
      %table.table.projects
        %tbody
          %tr
            %td{:style => 'border:none; background: white; text-align: right;'} 
              %b SubTotal:
            %td#sub_total_cell.money{:style => 'border:none; background: white; width:20%;'}
              =@sales_order_invoice.sub_total
          %tr
            %td{:style => 'border:none; background: white; text-align: right;'} 
              %b Total Discount:
            %td#discount_total_cell.money{:style => 'border:none; background: white; width:20%;'}
              =@sales_order_invoice.discount 
          %tr
            %td{:style => 'border:none; background: white; text-align: right;'} 
              %b Shipping Cost:
            %td#ship_total_cell.money{:style => 'border:none; background: white; width:20%;'}
              / =@sales_order.shipping_cost
          %tr
            %td{:style => 'border:none; background: white; text-align: right;'} 
              %b Tax:
            %td#tax_total_cell.money{:style => 'border:none; background: white; width:20%;'}
              =@sales_order_invoice.tax
          %tr
            %td{:style => 'border:none; background: white; text-align: right;'} 
              %b Total:
            %td#total_cell.money{:style => 'border:none; background: white; width:20%;'}
              =@sales_order_invoice.total

  .ln_solid
  .row.no-margin
    .col-md-12{:style => "overflow:auto;"}
      %h4 Invoice List
      %div
        %table#invoice_activity_list.activity_list.table.table-bordered.projects.margin-bottom-5
          %thead
            %tr
              %th Invoice Number
              %th Invoice Date
              %th Shipping Number
              %th Updated By
              %th 
          - @sales_order.invoice_activities.each do |item| 
            %tr
              %td 
                %a.invoice_link{href: 'javascript:;', "data-token": item.token} 
                  =item.token
              %td 
                =item.created_at.to_date
              %td 
                =item.activity_data
              %td 
                =item.updated_by.email
              %td 
                %a.remove_track_link{href: 'javascript:;', "data-activity": item.token} 
                  %i.fa.fa-icon.fa-minus-circle
:javascript
  $(document).ready(function() {
    SalesOrderDetail.handleOrderInvoiceTab();
  });
